<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            margin-right: 10px;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85em;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 8px;
            overflow: hidden;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .summary-card h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .summary-row:last-child {
            border-bottom: none;
            font-size: 1.3em;
            font-weight: bold;
            margin-top: 10px;
            padding-top: 15px;
        }

        .empty-state {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        .badge {
            display: inline-block;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .badge-advance {
            background: #fff3cd;
            color: #856404;
        }

        .badge-leave {
            background: #d1ecf1;
            color: #0c5460;
        }

        .badge-employee {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            margin: 5px;
            display: inline-block;
        }

        .employee-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .employee-item {
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-width: 200px;
        }

        .employee-item:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .employee-item.active {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .employee-name {
            font-weight: 600;
            color: #333;
        }

        .employee-item.active .employee-name {
            color: #667eea;
        }

        .current-employee {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 1.2em;
            font-weight: 600;
        }

        .all-summary {
            background: #27ae60;
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .all-summary h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8em;
            }

            .employee-item {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üí∞ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</h1>
            <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏•‡∏≤‡∏á‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</p>
        </div>

        <div class="content">
            <!-- ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á -->
            <div class="section">
                <h2>üë• ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á</h2>
                <div class="form-row">
                    <div class="form-group">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á</label>
                        <input type="text" id="employeeName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á">
                    </div>
                </div>
                <button class="btn btn-primary" onclick="addEmployee()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á</button>
                
                <div class="employee-list" id="employeeList">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>

            <!-- ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å -->
            <div id="currentEmployeeSection" style="display: none;">
                <div class="current-employee">
                    üë§ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£: <span id="currentEmployeeName"></span>
                </div>

                <!-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô -->
                <div class="section">
                    <h2>‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" id="dailySalary" value="500" min="0" step="0.01" onchange="updateEmployeeSettings()">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</label>
                            <input type="number" id="workingDays" value="30" min="1" onchange="updateEmployeeSettings()">
                        </div>
                    </div>
                </div>

                <!-- ‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô -->
                <div class="section">
                    <h2>üíµ ‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏ö‡∏¥‡∏Å</label>
                            <input type="date" id="advanceDate">
                        </div>
                        <div class="form-group">
                            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó)</label>
                            <input type="number" id="advanceAmount" min="0" step="0.01" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                            <input type="text" id="advanceNote" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô‡∏•‡πà‡∏ß‡∏á‡∏´‡∏ô‡πâ‡∏≤">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addAdvance()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô</button>
                </div>

                <!-- ‡∏•‡∏≤‡∏á‡∏≤‡∏ô -->
                <div class="section">
                    <h2>üèñÔ∏è ‡∏•‡∏≤‡∏á‡∏≤‡∏ô</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏≤</label>
                            <input type="date" id="leaveDate">
                        </div>
                        <div class="form-group">
                            <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏•‡∏≤</label>
                            <select id="leaveType">
                                <option value="sick">‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢</option>
                                <option value="personal">‡∏•‡∏≤‡∏Å‡∏¥‡∏à</option>
                                <option value="vacation">‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô</option>
                                <option value="unpaid">‡∏•‡∏≤‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</label>
                            <input type="text" id="leaveNote" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢">
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addLeave()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏≤</button>
                </div>

                <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô -->
                <div class="section">
                    <h2>üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô</h2>
                    <div class="table-container">
                        <table id="advanceTable">
                            <thead>
                                <tr>
                                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</th>
                                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                    <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                </tr>
                            </thead>
                            <tbody id="advanceTableBody">
                                <tr>
                                    <td colspan="4" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏á‡∏≤‡∏ô -->
                <div class="section">
                    <h2>üìÖ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏≤‡∏á‡∏≤‡∏ô</h2>
                    <div class="table-container">
                        <table id="leaveTable">
                            <thead>
                                <tr>
                                    <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th>
                                    <th>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</th>
                                    <th>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</th>
                                    <th>‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                                </tr>
                            </thead>
                            <tbody id="leaveTableBody">
                                <tr>
                                    <td colspan="4" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏≤</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô -->
                <div class="summary-card">
                    <h3>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì - <span id="summaryEmployeeName"></span></h3>
                    <div class="summary-row">
                        <span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô:</span>
                        <span id="summaryDailySalary">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="summary-row">
                        <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô:</span>
                        <span id="summaryWorkingDays">0 ‡∏ß‡∏±‡∏ô</span>
                    </div>
                    <div class="summary-row">
                        <span>‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏£‡∏ß‡∏°:</span>
                        <span id="summaryTotalSalary">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="summary-row">
                        <span>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏•‡∏≤:</span>
                        <span id="summaryLeaveDays">0 ‡∏ß‡∏±‡∏ô</span>
                    </div>
                    <div class="summary-row">
                        <span>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏Å‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏•‡∏≤:</span>
                        <span id="summaryLeaveDeduction">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="summary-row">
                        <span>‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô:</span>
                        <span id="summaryTotalAdvance">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                    <div class="summary-row">
                        <span>üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢:</span>
                        <span id="summaryFinalAmount">0.00 ‡∏ö‡∏≤‡∏ó</span>
                    </div>
                </div>
            </div>

            <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
            <div class="all-summary" id="allSummarySection" style="display: none;">
                <h3>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                <div id="allSummaryContent"></div>
                <div class="summary-row">
                    <span>üí∞ ‡∏£‡∏ß‡∏°‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                    <span id="allSummaryTotal">0.00 ‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        let employees = {}; // { id: { name, dailySalary, workingDays, advances: [], leaves: [] } }
        let currentEmployeeId = null;

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage
        function loadData() {
            const saved = localStorage.getItem('employees');
            if (saved) {
                employees = JSON.parse(saved);
            }
            updateEmployeeList();
        }

        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        function saveData() {
            localStorage.setItem('employees', JSON.stringify(employees));
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á
        function addEmployee() {
            const name = document.getElementById('employeeName').value.trim();
            if (!name) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á');
                return;
            }

            const id = Date.now();
            employees[id] = {
                name: name,
                dailySalary: 500,
                workingDays: 30,
                advances: [],
                leaves: []
            };

            document.getElementById('employeeName').value = '';
            saveData();
            updateEmployeeList();
            selectEmployee(id);
        }

        // ‡∏•‡∏ö‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á
        function deleteEmployee(id) {
            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö ${employees[id].name} ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                delete employees[id];
                if (currentEmployeeId === id) {
                    currentEmployeeId = null;
                    document.getElementById('currentEmployeeSection').style.display = 'none';
                }
                saveData();
                updateEmployeeList();
                updateAllSummary();
            }
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á
        function updateEmployeeList() {
            const list = document.getElementById('employeeList');
            const ids = Object.keys(employees);

            if (ids.length === 0) {
                list.innerHTML = '<div class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á</div>';
                return;
            }

            list.innerHTML = ids.map(id => {
                const emp = employees[id];
                const isActive = currentEmployeeId === id ? 'active' : '';
                return `
                    <div class="employee-item ${isActive}" onclick="selectEmployee(${id})">
                        <span class="employee-name">${emp.name}</span>
                        <button class="btn btn-danger btn-small" onclick="event.stopPropagation(); deleteEmployee(${id})">üóëÔ∏è</button>
                    </div>
                `;
            }).join('');

            updateAllSummary();
        }

        // ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á
        function selectEmployee(id) {
            currentEmployeeId = id;
            const emp = employees[id];
            
            document.getElementById('currentEmployeeName').textContent = emp.name;
            document.getElementById('summaryEmployeeName').textContent = emp.name;
            document.getElementById('dailySalary').value = emp.dailySalary;
            document.getElementById('workingDays').value = emp.workingDays;
            
            document.getElementById('currentEmployeeSection').style.display = 'block';
            
            updateTables();
            updateSummary();
            updateEmployeeList();
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á
        function updateEmployeeSettings() {
            if (!currentEmployeeId) return;
            
            const emp = employees[currentEmployeeId];
            emp.dailySalary = parseFloat(document.getElementById('dailySalary').value) || 0;
            emp.workingDays = parseInt(document.getElementById('workingDays').value) || 30;
            
            saveData();
            updateSummary();
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô
        function addAdvance() {
            if (!currentEmployeeId) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            const date = document.getElementById('advanceDate').value;
            const amount = parseFloat(document.getElementById('advanceAmount').value);
            const note = document.getElementById('advanceNote').value;

            if (!date) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà');
                return;
            }

            if (!amount || amount <= 0) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                return;
            }

            employees[currentEmployeeId].advances.push({
                id: Date.now(),
                date: date,
                amount: amount,
                note: note || '‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô'
            });

            document.getElementById('advanceDate').value = '';
            document.getElementById('advanceAmount').value = '';
            document.getElementById('advanceNote').value = '';

            saveData();
            updateTables();
            updateSummary();
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏•‡∏≤
        function addLeave() {
            if (!currentEmployeeId) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏•‡∏π‡∏Å‡∏ô‡πâ‡∏≠‡∏á‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }

            const date = document.getElementById('leaveDate').value;
            const type = document.getElementById('leaveType').value;
            const note = document.getElementById('leaveNote').value;

            if (!date) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà');
                return;
            }

            const typeNames = {
                'sick': '‡∏•‡∏≤‡∏õ‡πà‡∏ß‡∏¢',
                'personal': '‡∏•‡∏≤‡∏Å‡∏¥‡∏à',
                'vacation': '‡∏•‡∏≤‡∏û‡∏±‡∏Å‡∏ú‡πà‡∏≠‡∏ô',
                'unpaid': '‡∏•‡∏≤‡∏Ç‡∏≤‡∏î‡∏á‡∏≤‡∏ô'
            };

            employees[currentEmployeeId].leaves.push({
                id: Date.now(),
                date: date,
                type: type,
                typeName: typeNames[type],
                note: note || typeNames[type]
            });

            document.getElementById('leaveDate').value = '';
            document.getElementById('leaveNote').value = '';

            saveData();
            updateTables();
            updateSummary();
        }

        // ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô
        function deleteAdvance(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                const emp = employees[currentEmployeeId];
                emp.advances = emp.advances.filter(a => a.id !== id);
                saveData();
                updateTables();
                updateSummary();
            }
        }

        // ‡∏•‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏≤
        function deleteLeave(id) {
            if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                const emp = employees[currentEmployeeId];
                emp.leaves = emp.leaves.filter(l => l.id !== id);
                saveData();
                updateTables();
                updateSummary();
            }
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô
        function updateAdvanceTable() {
            if (!currentEmployeeId) return;
            
            const tbody = document.getElementById('advanceTableBody');
            const emp = employees[currentEmployeeId];
            const advances = emp.advances;
            
            if (advances.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏¥‡∏Å‡πÄ‡∏á‡∏¥‡∏ô</td></tr>';
                return;
            }

            tbody.innerHTML = advances.map(advance => `
                <tr>
                    <td>${formatDate(advance.date)}</td>
                    <td>${formatCurrency(advance.amount)}</td>
                    <td>${advance.note}</td>
                    <td>
                        <button class="btn btn-danger btn-small" onclick="deleteAdvance(${advance.id})">üóëÔ∏è ‡∏•‡∏ö</button>
                    </td>
                </tr>
            `).join('');
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏•‡∏≤
        function updateLeaveTable() {
            if (!currentEmployeeId) return;
            
            const tbody = document.getElementById('leaveTableBody');
            const emp = employees[currentEmployeeId];
            const leaves = emp.leaves;
            
            if (leaves.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="empty-state">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏≤</td></tr>';
                return;
            }

            tbody.innerHTML = leaves.map(leave => `
                <tr>
                    <td>${formatDate(leave.date)}</td>
                    <td><span class="badge badge-leave">${leave.typeName}</span></td>
                    <td>${leave.note}</td>
                    <td>
                        <button class="btn btn-danger btn-small" onclick="deleteLeave(${leave.id})">üóëÔ∏è ‡∏•‡∏ö</button>
                    </td>
                </tr>
            `).join('');
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function updateTables() {
            updateAdvanceTable();
            updateLeaveTable();
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô
        function updateSummary() {
            if (!currentEmployeeId) return;
            
            const emp = employees[currentEmployeeId];
            const totalLeaveDays = emp.leaves.length;
            const totalSalary = emp.dailySalary * emp.workingDays;
            const leaveDeduction = emp.dailySalary * totalLeaveDays;
            const totalAdvance = emp.advances.reduce((sum, a) => sum + a.amount, 0);
            const finalAmount = totalSalary - leaveDeduction - totalAdvance;

            document.getElementById('summaryDailySalary').textContent = formatCurrency(emp.dailySalary);
            document.getElementById('summaryWorkingDays').textContent = `${emp.workingDays} ‡∏ß‡∏±‡∏ô`;
            document.getElementById('summaryTotalSalary').textContent = formatCurrency(totalSalary);
            document.getElementById('summaryLeaveDays').textContent = `${totalLeaveDays} ‡∏ß‡∏±‡∏ô`;
            document.getElementById('summaryLeaveDeduction').textContent = formatCurrency(leaveDeduction);
            document.getElementById('summaryTotalAdvance').textContent = formatCurrency(totalAdvance);
            document.getElementById('summaryFinalAmount').textContent = formatCurrency(Math.max(0, finalAmount));
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function updateAllSummary() {
            const ids = Object.keys(employees);
            const summarySection = document.getElementById('allSummarySection');
            
            if (ids.length === 0) {
                summarySection.style.display = 'none';
                return;
            }

            summarySection.style.display = 'block';
            
            let totalAll = 0;
            const summaryContent = ids.map(id => {
                const emp = employees[id];
                const totalLeaveDays = emp.leaves.length;
                const totalSalary = emp.dailySalary * emp.workingDays;
                const leaveDeduction = emp.dailySalary * totalLeaveDays;
                const totalAdvance = emp.advances.reduce((sum, a) => sum + a.amount, 0);
                const finalAmount = totalSalary - leaveDeduction - totalAdvance;
                totalAll += Math.max(0, finalAmount);

                return `
                    <div class="summary-row">
                        <span>${emp.name}:</span>
                        <span>${formatCurrency(Math.max(0, finalAmount))}</span>
                    </div>
                `;
            }).join('');

            document.getElementById('allSummaryContent').innerHTML = summaryContent;
            document.getElementById('allSummaryTotal').textContent = formatCurrency(totalAll);
        }

        // ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà
        function formatDate(dateString) {
            const date = new Date(dateString + 'T00:00:00');
            const day = date.getDate();
            const month = date.getMonth() + 1;
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }

        // ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏á‡∏¥‡∏ô
        function formatCurrency(amount) {
            return new Intl.NumberFormat('th-TH', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount) + ' ‡∏ö‡∏≤‡∏ó';
        }

        // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('advanceDate').value = today;
            document.getElementById('leaveDate').value = today;
        }

        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        loadData();
        setTodayDate();

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏ß‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á
        setInterval(() => {
            if (Object.keys(employees).length > 0) {
                updateAllSummary();
            }
        }, 1000);
    </script>
</body>
</html>